<section class="mt-12">
    {{ $related := .Site.RegularPages.Related . | first 5 }}
    {{ if $related }}
      <h2 class="text-2xl font-bold text-gray-800 dark:text-gray-100 mb-4">Related content</h2>
      <ul class="space-y-4">
        {{ range $i, $p := $related }}
          <li class="bg-gray-100 dark:bg-gray-800 p-4 rounded-lg shadow-md">
            <a href="{{ $p.RelPermalink }}" class="text-blue-600 hover:underline text-lg font-semibold">{{ $p.LinkTitle }}</a>
            {{ with $p.HeadingsFiltered }}
              {{ if (and (reflect.IsSlice .) (gt (len .) 0)) }}
                <ul class="mt-2 space-y-2">
                  {{ range . }}
                    {{ $link := printf "%s#%s" $p.RelPermalink .ID | safeURL }}
                    <li>
                      <a href="{{ $link }}" class="text-blue-500 hover:underline text-sm">{{ .Title }}</a>
                    </li>
                  {{ end }}
                </ul>
              {{ else }}
                <p class="text-sm text-gray-500">No headings available.</p>
              {{ end }}
            {{ end }}
          </li>
        {{ end }}
      </ul>
    {{ else }}
      <p class="text-gray-500">No related content found.</p>
    {{ end }}
  </section>